# highload
Проектирование веб-сервиса

## 1. Тема проекта:
Стриминговый аудио сервис - https://music.yandex.ru/

## 2. Целевая аудитория сервиса:
Статистику взяла с <https://radar.yandex.ru/yandex?month=2021-01>

Месячная аудитория в среднем порядка 12 млн п/мес.

Дневная аудитория в среднем 2 млн п/мес.

Время среднее 3ч 23мин = 203 мин аудиоконтента в день.


## 3. MVP проекта:
 1 - Авторизация, регистрация. 2 - Музыка пользователя, плейлисты (популярные, дневной).  
 
 Будем рассматривать основной функционал - прослушивание музыки.
 

## 4. Выбор планируемой нагрузки:
Нагрузку на добавление песен можно не учитывать, так как она достаточно мала и незначительна по сравнению с нагрузкой, которая приходится на отдачу музыки.

Имеем, что в среднем пользователь сервиса в день слушает 203 минуты аудиоконтента. Среднее количество пользователей в день 2 миллона.
Будем считать, что сервис передает треки в максимальном качестве с битрейтом 320 kbps. Передачу среднего качества музыки возьмем равным 192 kbps.
Данные взяла из статьи <https://roem.ru/02-02-2016/218250/music-yandex-hifi/>

Таким образом, **минимальный вес с максимальным качеством за 1 минуту**: 320(kbps) * 60(сек) = 19200 КБит = 2400 КБайт = 2,34375 МБайта ~ 2,344 МБайта.

Возьмем среднюю величину, а именно с битрейтом 192 kbps, и будем считать, что это минимально возможный вес песни. Помимо этого, сервис сам может регулировать нагрузку и снижать битрейт при необходимости.

Получаем **минимальный вес 1 минуты**: 192(kbps) * 60(сек) = 11400 КБит = 1425 КБайт ~ 1,391 МБайта.


Так как большая часть музыки все же передается со средним качеством музыки, части песен нет в максимальном качестве, и не все пользователи слушают платную Яндекс.Музыку, то будем считать, чо у нас в сервисе в среднем 50% музыки с битрейтом 192 kbps и 50% музыки с битрейтом 320 kbps. Так же предположим, что пользователь будет слушать и ту, и другую музыку равновероятно.

Постчитаем **средний вес одной минуты песни**: (2,344 МБ + 1,391 МБ)/2 ~ 1,867 МБайт.

Значит, **один пользователь скачивает за день** в среднем: 203(мин) * 1,867(МБ) = 379,001 МБайт аудиоконтента.

За **один день в среднем с нашего сайта скачивается** 379,001(МБ) * 2 000 000(пользоветелй) = 758 002 000 МБайт  музыки ~ 722,887 ТБайт

Учтем, что при дневном пике нагрузка возрастает в 2.5 раза.

Таким образом, **в дневной пик количество пользователей** увеличивается до 2,5 x (2(млн польз.)/24)(среднее кол-во пользователей в час) ~ 208 333 пользоветеле в час.
**Нагрузка на дневной пик** составляет 379,001(МБ) * 208333(польз./час) ~ 78 958 415 МБайт в час = 75,3 ТБайт в час.
